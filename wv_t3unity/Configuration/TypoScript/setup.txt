[globalVar = GP:mode = page]
page = PAGE
page {
    typeNum = 0
    config.disableAllHeaderCode = 1
    config.metaCharset = UTF-8

    10 = FLUIDTEMPLATE
    10 {
        // Define BE Layouts
		file.stdWrap.cObject = CASE
		file.stdWrap.cObject {
			key.data = levelfield:-1, backend_layout_next_level, slide
			key.override.field = backend_layout

            default = TEXT
			default.value = EXT:wv_t3unity/Resources/Private/Templates/1column.html

            wv_t3unity__1column = TEXT
            wv_t3unity__1column.value = EXT:wv_t3unity/Resources/Private/Templates/1column.html

            wv_t3unity__2columns-left = TEXT
            wv_t3unity__2columns-left.value = EXT:wv_t3unity/Resources/Private/Templates/2columns-left.html

            wv_t3unity__2columns-right = TEXT
            wv_t3unity__2columns-right.value = EXT:wv_t3unity/Resources/Private/Templates/2columns-right.html

            wv_t3unity__3columns = TEXT
            wv_t3unity__3columns.value = EXT:wv_t3unity/Resources/Private/Templates/3columns.html
        }

        // Define paths for templates
		templateRootPath = EXT:wv_t3unity/Resources/Private/Templates/
        partialRootPath = EXT:wv_t3unity/Resources/Private/Partials/
        layoutRootPath = EXT:wv_t3unity/Resources/Private/Layouts/

        // Set variables in templates and render content
        // Variables in template
        variables {
            content < styles.content.get
            content.select.where = colPos=1

            sidebar_left < styles.content.get
            sidebar_left.select.where = colPos=2

            sidebar_right < styles.content.get
            sidebar_right.select.where = colPos=3
        }
    }
}
[global]

[globalVar = GP:mode = column]
page = PAGE
page {
    typeNum = 0
    config.disableAllHeaderCode = 1
    config.metaCharset = UTF-8

    10 = TEMPLATE
    10.template = TEXT
    10.template.value = ###CONTENT###
    10.marks {
        CONTENT < styles.content.get
        CONTENT.select.where = colPos={GP:colPos}
        CONTENT.select.where.insertData = 1
    }
}
[global]

[globalVar = GP:mode = element]
page = PAGE
page {
    typeNum = 0
    config.disableAllHeaderCode = 1
    config.metaCharset = UTF-8

    10 = TEMPLATE
    10.template = TEXT
    10.template.value = ###CONTENT###
    10.marks {
        CONTENT = RECORDS
        CONTENT.tables = tt_content
        CONTENT.source.data = GP:uid
        CONTENT.dontCheckPid = 1
    }
}
[global]

[globalVar = GP:mode = menu]
    page = PAGE
    page {
        typeNum = 0
        config.disableAllHeaderCode = 1
        config.metaCharset = UTF-8
        10 = CASE
        10 {
            key.data = GP:layout

            default = CASE
            default {
                key.data = GP:special

                default = HMENU
                default {
                    special = directory
                    special.value.data = GP:special-value

                    wrap = <nav class="t3-menu t3-directory">|</nav>

                    1 = TMENU
                    1 {
                        expAll = 1
                        wrap = <ul class="t3-menu-list">|</ul>
                        NO = 1
                        NO {
                            doNotLinkIt = 1
                            allWrap = <a href="{field: unity_path}">|</a>
                            allWrap.insertData = 1
                            wrapItemAndSub = <li class="first">|</li> |*| <li>|</li> |*| <li class="last">|</li>
                        }
                        ACT < .NO
                        ACT {
                            wrapItemAndSub = <li class="first active">|</li> |*| <li class="active">|</li> |*| <li class="last active">|</li>
                        }
                        IFSUB < .NO
                        IFSUB {
                            wrapItemAndSub = <li class="first hassub">|</li> |*| <li class="hassub">|</li> |*| <li class="last hassub">|</li>
                        }
                        ACTIFSUB < .NO
                        ACTIFSUB {
                            wrapItemAndSub = <li class="first active hassub">|</li> |*| <li class="active hassub">|</li> |*| <li class="last active hassub">|</li>
                        }
                    }
                    2 < .1
                    2 {
                        wrap = <ul class="t3-menu-sublist">|</ul>
                    }
                    3 < .2
                }
                list < .default
                list {
                    wrap = <nav class="t3-menu t3-list">|</nav>
                    special = list
                    1 {
                        expAll = 1
                        IFSUB < .NO
                        ACTIFSUB < .ACT
                    }
                }
            }

            menuItem < .default
            menuItem {
                default {
                    wrap >
                    1 {
                        wrap >
                        NO.wrapItemAndSub = <li>|</li>
                        ACT.wrapItemAndSub = <li class="active">|</li>
                        IFSUB.wrapItemAndSub = <li class="hassub">|</li>
                        ACTIFSUB.wrapItemAndSub = <li class="active hassub">|</li>
                    }
                }
                list {
                    wrap >
                    1 {
                        wrap >
                        NO.wrapItemAndSub = <li>|</li>
                        ACT.wrapItemAndSub = <li class="active">|</li>
                        IFSUB.wrapItemAndSub = <li class="hassub">|</li>
                        ACTIFSUB.wrapItemAndSub = <li class="active hassub">|</li>
                    }
                }
            }
        }
    }
[global]

headerData = PAGE
headerData {
    typeNum = 777
    config.disableAllHeaderCode = 1

    10 = TEMPLATE
    10.template = TEXT
    10.template.value (
{
    "title": "###TITLE###",
    "keywords": "###KEYWORDS###",
    "description": "###DESCRIPTION###",
    "canonical": "###CANONICAL###",
    "includeJs":[###INCLUDEJS###],
    "includeCss":[###INCLUDECSS###],
    "includeFooterJs":[###INCLUDEFOOTERJS###],
    "includeFooterCss":[###INCLUDEFOOTERCSS###]
}
    )
    10.marks {
        TITLE = TEXT
        TITLE.data = page:title
        KEYWORDS = TEXT
        KEYWORDS.data = page:keywords
        DESCRIPTION = TEXT
        DESCRIPTION.data = page:description
        CANONICAL = TEXT
        CANONICAL.data = page:canonical_url
        INCLUDEJS = USER
        INCLUDEJS.userFunc = WebVision\WvT3unity\Service\HeaderDataService->getIncludeJs
        INCLUDECSS = USER
        INCLUDECSS.userFunc = WebVision\WvT3unity\Service\HeaderDataService->getIncludeCss
        INCLUDEFOOTERJS = USER
        INCLUDEFOOTERJS.userFunc = WebVision\WvT3unity\Service\HeaderDataService->getIncludeFooterJs
        INCLUDEFOOTERCSS = USER
        INCLUDEFOOTERCSS.userFunc = WebVision\WvT3unity\Service\HeaderDataService->getIncludeFooterCss
    }
}

plugin.tx_wvt3unity >
plugin.tx_wvt3unity = COA
plugin.tx_wvt3unity {

	# Append a line break for every header tag
	5 = TEXT
	5.value (


)

	# Building the page title
	10 = TEXT
	10.data = page:title
	10.trim = 1
	10.stdWrap.stdWrap.append = TEXT
	10.stdWrap.stdWrap.append.data = TSFE:tmpl|sitetitle
	10.stdWrap.stdWrap.append.trim = 1
	10.stdWrap.stdWrap.append.noTrimWrap = | - ||
	10.stdWrap.insertData = 1
	10.htmlSpecialChars = 1
	10.wrap = <title>|</title>
	10.append < .5

	20 < .10
	20.wrap = <meta name="title" content="|" />


	# Building the Keywords tag
	30 = TEXT
	30 < .10
	30.data = page:keywords
	30.stdWrap.noTrimWrap = {$plugin.tx_wvt3unity.keywordsWrap}
	30.stdWrap.stdWrap >
	30.required = 1
	30.wrap = <meta name="keywords" content="|" />


	# Building the Description tag
	40 = TEXT
	40 < .30
	40.data = page:description
	40.stdWrap.noTrimWrap = {$plugin.tx_wvt3unity.descriptionWrap}
	40.wrap = <meta name="description" content="|" />


	# Building the date tag (last changed)
	50 = TEXT
	50 < .10
	50.data = page:SYS_LASTCHANGED // page:crdate
	50.date = Y-m-d
	50.stdWrap >
	50.wrap = <meta name="date" content="|" />

	# Building the canonical tag
	60 = TEXT
	60 < .10
	60.data >
	60.cObject = USER
	60.cObject.userFunc = WebVision\WvT3unity\Service\UrlService->getCanonicalUrl
	#60.cObject.useDomain = current
	60.required = 1
	60.if.isTrue = {$plugin.tx_seo.enableCanonicalTag}
	60.stdWrap >
	60.wrap = <link rel="canonical" href="|" />
}


# activate SEO in main "page." configuration
# config.noPageTitle = 2
page.headerData.776 = < plugin.tx_wvt3unity

